services:
  streamrecorder:
    build: .
    image: streamrecorder:latest
    container_name: streamrecorder
    
    # Environment variables
    environment:
      - STREAM_URL=${STREAM_URL}
      - TIMEZONE=${TIMEZONE:-Europe/Vienna}
      - OUTPUT_DIR=${OUTPUT_DIR:-/recordings}
      - PORT=${PORT:-3000}
    
    # Volume mount for recordings
    # Uses RECORDINGS_PATH from .env file, defaults to ./recordings if not set
    volumes:
      - "${RECORDINGS_PATH:-./recordings}:/recordings"
    
    # Expose web interface port
    ports:
      - "${PORT:-3000}:3000"
    
    # Restart policy: always (web server should stay running)
    restart: unless-stopped
    
    # Network mode: bridge (default)
    network_mode: bridge
    
    # Optional: resource limits
    # deploy:
    #   resources:
    #     limits:
    #       cpus: '1.0'
    #       memory: 512M

# Usage:
# Start the web interface:
#   docker compose up -d
#
# Access the web interface at:
#   http://localhost:3000
#
# For command-line usage (legacy), you can still run:
#   docker compose run --rm streamrecorder python3 /app/recorder.py 60 morning_show

